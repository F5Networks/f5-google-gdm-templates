# Build System

### Note: Tech Writers go to [this guide](docs/WRITERS.md) instead.


## Quick Start

	cd <project_root>/build
	cp makefile.local.example makefile.local
	vi makefile.local
	make
	
## INDEX

- [Directory Structure](#Directory-Structure)
- [Make](#Make)
- [Jinja2](#Jinja2)
- [Testing](#Testing)
- [Documentation](#Documentation)

## Directory Structure

note; italizised directories are build ephemeral, ie not in git and deleted during clean

- bin/ - contains any scripts we need for the build process
- src/ - contains the source files (templates to generate stuff)
- include/ - contains the master templates and includes bits
- *target/* - is where the system builds into 
- *var/* - contains runtime artifacts like pid.lock and fifo
- *tmp/* - contains tmp files like generated data, etc
- *docs/* - contains script/code documentation generated by doxygen

## Make

GNU Make is being used.  Read about it.  the `Makefile` at the root of the build directory
contains the recipes, targets and instructions to build this project's artifacts.

- make \<target\>
  - clean - removes target and everything in it
  - all - cleans, compiles and packages the entire project
  - test - does just the test files
  - docs - builds the docs
  - templates - builds the templates (not yet implemented)
  - info - displays the data being used to create the templates
  - init - looks in root directory for all the stuff it's supposed to make and creates 
        seed files in the src directory to get you started.
  - diff - compares the generated docs in the target directory with the published docs
  - publish - copies the generated docs from the target directory into the appropriate 
        location next to the templates
 
 ## Yasha
 
 Yasha is a command line python script that parses jinja2 files without needing to write python code.  Install with pip after setting up your python virtualenv.
 ## Jinja2
 
 We are using [Jinja2](http://jinja.pocoo.org/docs/2.10/templates/#) as the templating language.  [Yasha](https://github.com/kblomqvist/yasha) is the command line tool to 
 compile the jinja templates into their target artifacts.
 
 We use [template Inheritance](http://jinja.pocoo.org/docs/2.10/templates/#template-inheritance) 
 and [Includes](http://jinja.pocoo.org/docs/2.10/templates/#include) to build up the unique artifacts from a Master Template and
 corrisponding template fragements.  The individual templates only contain the bits that are different.
 To create a new template simply place a jinja2 file and yaml file of the same name in a directory in 
 `src` and a corresponding file will be compiled from that template and the yaml data into the target directory.
  
  *(See the test directory for examples)*

## Testing

TBD

## Coding Documentation

We are using Doxygen to generate the internally facing docs for this project ( not the public readme ).  
More info to follow. Check out the doxygen.conf file in the build directory and the make:docs command.
